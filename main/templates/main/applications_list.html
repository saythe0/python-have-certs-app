{% extends 'main/base.html' %}

{% block content %}
<div class="container container-large">
	<h2>üìã –ú–æ–∏ –∑–∞—è–≤–∫–∏</h2>

	<a href="{% url 'application_create' %}" class="btn" style="margin-bottom: 30px;">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É</a>

	{% if applications %}
	<div class="applications-list">
		{% for application in applications %}
		<div class="application-card-full">
			<div class="application-header">
				<h3>{{ application.course_name }}</h3>
				<span class="status-badge status-{{ application.status }}">
					{{ application.get_status_display }}
				</span>
			</div>

			<div class="application-body">
				<div class="info-grid">
					<div class="info-item">
						<strong>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:</strong>
						<span>{{ application.start_date|date:"d. m.Y" }}</span>
					</div>

					<div class="info-item">
						<strong>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</strong>
						<span>{{ application.get_payment_method_display }}</span>
					</div>

					<div class="info-item">
						<strong>–°—Ç–∞—Ç—É—Å:</strong>
						<span>{{ application.get_status_display }}</span>
					</div>

					<div class="info-item">
						<strong>–î–∞—Ç–∞ –ø–æ–¥–∞—á–∏:</strong>
						<span>{{ application.created_at|date:"d. m.Y H:i" }}</span>
					</div>
				</div>
			</div>

			{% if application.status == 'completed' %}
			{% if application.review %}
			<div class="review-section">
				<h4>üìù –í–∞—à –æ—Ç–∑—ã–≤:</h4>
				<div class="review-text">
					{{ application.review.text }}
				</div>
				<p class="review-date">–û—Å—Ç–∞–≤–ª–µ–Ω: {{ application.review.created_at|date:"d.m.Y H:i" }}</p>
			</div>
			{% else %}
			<div class="review-action">
				<p>‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –û—Å—Ç–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤ –æ –∫—É—Ä—Å–µ.</p>
				<a href="{% url 'review_create' application.pk %}" class="btn btn-review">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</a>
			</div>
			{% endif %}
			{% endif %}
		</div>
		{% endfor %}
	</div>
	{% else %}
	<p class="no-data">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞—è–≤–æ–∫. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é! </p>
	{% endif %}
</div>
{% endblock %}